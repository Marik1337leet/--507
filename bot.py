import os
import asyncio
import logging
from datetime import datetime
from aiogram import Bot, Dispatcher, types, F
from aiogram.filters import Command
from aiogram.client.default import DefaultBotProperties
from aiogram.enums import ParseMode
from apscheduler.schedulers.asyncio import AsyncIOScheduler
from apscheduler.triggers.cron import CronTrigger

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# üîë –¢–æ–∫–µ–Ω –±–æ—Ç–∞ —Ç–µ–ø–µ—Ä—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
TOKEN = os.getenv("BOT_TOKEN")

# ID –≥—Ä—É–ø–ø—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
GROUP_CHAT_ID = None

# ‚ö° –í–ü–ò–®–ò–¢–ï –°–Æ–î–ê ID –í–ê–®–ò–• –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–û–í ‚ö°
ADMIN_IDS = {5810097604}  # –ó–∞–º–µ–Ω–∏—Ç–µ —ç—Ç–∏ —á–∏—Å–ª–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é –Ω–µ–¥–µ–ª—é
START_DATE = datetime(2024, 9, 1)
def get_current_week():
    now = datetime.now()
    delta = now - START_DATE
    week_number = delta.days // 7
    return "–≤–µ—Ä—Ö–Ω—è—è" if week_number % 2 == 0 else "–Ω–∏–∂–Ω—è—è"

# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –¥–Ω—è–º —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –Ω–µ–¥–µ–ª–∏
schedule = {
    "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": {
        "–≤–µ—Ä—Ö–Ω—è—è": """üìÖ –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ (–í–µ—Ä—Ö–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
2. –ö–æ–Ω—Å—Ç—Ä. –ø—Ä–æ–≥—Ä–∞–º–º. –∏ –ø—Ä–æ–≥—Ä. (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –®–∏–Ω–∫–∞—Ä–µ–≤–∞ –¢.–ê., –∫–∞–±.302, 508)
3. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –∫–∞–±.306, 502)
4. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –ê–≥–µ–µ–≤–∞ –ê.–ê., –∫–∞–±.306, 502)""",
        
        "–Ω–∏–∂–Ω—è—è": """üìÖ –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ (–ù–∏–∂–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. ***–ü–∞—Ä—ã –Ω–µ—Ç—É ‚úÖ***
2. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
3. –ö–æ–Ω—Å—Ç—Ä. –ø—Ä–æ–≥—Ä–∞–º–º. –∏ –ø—Ä–æ–≥—Ä. (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –®–∏–Ω–∫–∞—Ä–µ–≤–∞ –¢.–ê., –∫–∞–±.302, 508)
4. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –∫–∞–±.306, 502)
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)"""
    },
    
    "–≤—Ç–æ—Ä–Ω–∏–∫": {
        "–≤–µ—Ä—Ö–Ω—è—è": """üìÖ –í—Ç–æ—Ä–Ω–∏–∫ (–í–µ—Ä—Ö–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
2. –§–ö –∏ –ó (–ù–∏–∫–∏—Ç—é–∫ –ò.–û., –°—É–¥–∞—Ä–∫–æ–≤ –ò.–ê., —Å–ø–æ—Ä—Ç–∑–∞–ª)
3. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –ë–∞–∑–∞–Ω–æ–≤–∞ –î.–õ., –∫–∞–±.507, 305)
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–∏–º–æ–≤–∞ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)""",
        
        "–Ω–∏–∂–Ω—è—è": """üìÖ –í—Ç–æ—Ä–Ω–∏–∫ (–ù–∏–∂–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
2. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –ê–≥–µ–µ–≤–∞ –ê.–ê., –∫–∞–±.306, 502)
3. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –ë–∞–∑–∞–Ω–æ–≤–∞ –î.–õ., –∫–∞–±.507, 305)
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)"""
    },

    "—Å—Ä–µ–¥–∞": {
        "–≤–µ—Ä—Ö–Ω—è—è": """üìÖ –°—Ä–µ–¥–∞ (–í–µ—Ä—Ö–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –¢–µ—Ö–Ω–∏–∫–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –∏ –æ—Å–Ω–æ–≤—ã –∫–æ–º–∞–Ω–¥–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (–Ø–∫—É—à–µ–≤–∞ –ù.–ì., –∫–∞–±.410)
2. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –ê–≥–µ–µ–≤–∞ –ê.–ê., –∫–∞–±.308, 502)
3. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –ë–∞–∑–∞–Ω–æ–≤–∞ –î.–õ., –∫–∞–±.507, 305)
4. –ö—É—Ä–∞—Ç–æ—Ä—Å–∫–∏–π —á–∞—Å
5. –ö–æ–Ω—Å—Ç—Ä. –ø—Ä–æ–≥—Ä–∞–º–º. –∏ –ø—Ä–æ–≥—Ä. (–ö–∞—Ä–∏–º–æ–≤–∞ –ê.–í., –®–µ–≤—Ü–æ–≤–∞ –¢.–ê., –∫–∞–±.302, 508)""",
        
        "–Ω–∏–∂–Ω—è—è": """üìÖ –°—Ä–µ–¥–∞ (–ù–∏–∂–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –¢–µ—Ö–Ω–∏–∫–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –∏ –æ—Å–Ω–æ–≤—ã –∫–æ–º–∞–Ω–¥–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (–Ø–∫—É—à–µ–≤–∞ –ù.–ì., –∫–∞–±.410)
2. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –ê–≥–µ–µ–≤–∞ –ê.–ê., –∫–∞–±.308, 502)
3. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –ë–∞–∑–∞–Ω–æ–≤–∞ –î.–õ., –∫–∞–±.507, 305)
4. –ö—É—Ä–∞—Ç–æ—Ä—Å–∫–∏–π —á–∞—Å
5. –ö–æ–Ω—Å—Ç—Ä. –ø—Ä–æ–≥—Ä–∞–º–º. –∏ –ø—Ä–æ–≥—Ä. (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –®–∏–Ω–∫–∞—Ä–µ–≤–∞ –¢.–ê., –∫–∞–±.302, 508)"""
    },

    "—á–µ—Ç–≤–µ—Ä–≥": {
        "–≤–µ—Ä—Ö–Ω—è—è": """üìÖ –ß–µ—Ç–≤–µ—Ä–≥ (–í–µ—Ä—Ö–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
2. –§–ö –∏ –ó (–ù–∏–∫–∏—Ç—é–∫ –ò.–û., –°—É–¥–∞—Ä–∫–æ–≤ –ò.–ê., —Å–ø–æ—Ä—Ç–∑–∞–ª)
3. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –ë–∞–∑–∞–Ω–æ–≤–∞ –î.–õ., –∫–∞–±.507, 305)
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)""",
        
        "–Ω–∏–∂–Ω—è—è": """üìÖ –ß–µ—Ç–≤–µ—Ä–≥ (–ù–∏–∂–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
2. –§–ö –∏ –ó (–ù–∏–∫–∏—Ç—é–∫ –ò.–û., –°—É–¥–æ–º–æ–∏–Ω –ò.–ê., —Å–ø–æ—Ä—Ç–∑–∞–ª)
3. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –ë–∞–∑–∞–Ω–æ–≤–∞ –î.–õ., –∫–∞–±.507, 305)
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)"""
    },

    "–ø—è—Ç–Ω–∏—Ü–∞": {
        "–≤–µ—Ä—Ö–Ω—è—è": """üìÖ –ü—è—Ç–Ω–∏—Ü–∞ (–í–µ—Ä—Ö–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)
2. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
3. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –∫–∞–±.306, 507)
4. –ö–æ–Ω—Å—Ç—Ä. –ø—Ä–æ–≥—Ä–∞–º–º. –∏ –ø—Ä–æ–≥—Ä. (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –®–∏–Ω–∫–∞—Ä–µ–≤–∞ –¢.–ê., –∫–∞–±.302, 508)""",
        
        "–Ω–∏–∂–Ω—è—è": """üìÖ –ü—è—Ç–Ω–∏—Ü–∞ (–ù–∏–∂–Ω—è—è –Ω–µ–¥–µ–ª—è)
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –ê–≥–µ–µ–≤ –ê.–ê., –∫–∞–±.302, 502)
2. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–î–µ–Ω–∏—Å–æ–≤–µ—Ü –î.–ê., –ü–æ–ø–∫–æ–≤–∞ –Æ.–ê., –∫–∞–±.307, 303)
3. –í–µ–±-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (–ö–æ—Ä–æ–ª–µ–≤–∞ –ê.–í., –õ–∏—Ç–≤–∏–Ω–æ–≤–∞ –õ.–ï., –∫–∞–±.306, 507)
4. –ö–æ–Ω—Å—Ç—Ä. –ø—Ä–æ–≥—Ä–∞–º–º. –∏ –ø—Ä–æ–≥—Ä. (–ö–∞—Ä–º–∞–Ω–æ–≤ –ê.–í., –®–∏–Ω–∫–∞—Ä–µ–≤–∞ –¢.–ê., –∫–∞–±.302, 508)"""
    },

    "—Å—É–±–±–æ—Ç–∞": "üìÖ –°—É–±–±–æ—Ç–∞ ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π üò¥",
    "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ": "üìÖ –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π üò¥"
}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
bot = Bot(token=TOKEN, default=DefaultBotProperties(parse_mode=ParseMode.HTML))
dp = Dispatcher()
scheduler = AsyncIOScheduler()

async def send_daily_schedule():
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å –≤ –≥—Ä—É–ø–ø—É –æ—Ç –∏–º–µ–Ω–∏ –†–ê–°–ü–ò–°–ê–ù–ò–ï"""
    if not GROUP_CHAT_ID:
        logger.warning("GROUP_CHAT_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        return
    
    today = datetime.now().strftime("%A").lower()
    days_map = {
        "monday": "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
        "tuesday": "–≤—Ç–æ—Ä–Ω–∏–∫",
        "wednesday": "—Å—Ä–µ–¥–∞",
        "thursday": "—á–µ—Ç–≤–µ—Ä–≥",
        "friday": "–ø—è—Ç–Ω–∏—Ü–∞",
        "saturday": "—Å—É–±–±–æ—Ç–∞",
        "sunday": "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"
    }
    
    day_rus = days_map.get(today)
    if not day_rus:
        return
    
    week_type = get_current_week()
    
    if day_rus in ["—Å—É–±–±–æ—Ç–∞", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"]:
        text = schedule.get(day_rus, "‚ùå –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è")
    else:
        day_schedule = schedule.get(day_rus)
        if day_schedule and isinstance(day_schedule, dict):
            text = day_schedule.get(week_type, "‚ùå –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è")
        else:
            text = "‚ùå –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è"
    
    try:
        message = f"<b>üìÖ –†–ê–°–ü–ò–°–ê–ù–ò–ï</b>\n\n{text}"
        await bot.send_message(GROUP_CHAT_ID, message)
        logger.info(f"–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è {day_rus} ({week_type} –Ω–µ–¥–µ–ª—è)")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {e}")

@dp.message(Command(commands=["start", "help"]))
async def cmd_start(message: types.Message):
    """–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥—Ä—É–ø–ø—ã"""
    global GROUP_CHAT_ID
    if message.chat.type in ["group", "supergroup"]:
        GROUP_CHAT_ID = message.chat.id
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∞–¥–º–∏–Ω—ã
        user_id = message.from_user.id
        await message.answer(
            f"‚úÖ –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —ç—Ç–æ–π –≥—Ä—É–ø–ø—ã!\n"
            f"‚Ä¢ –í–∞—à ID: {user_id}\n"
            f"‚Ä¢ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 7:00\n"
            f"‚Ä¢ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /–æ–±—ä—è–≤–ª–µ–Ω–∏–µ"
        )
    else:
        await message.answer("–î–æ–±–∞–≤—å—Ç–µ –º–µ–Ω—è –≤ –≥—Ä—É–ø–ø—É –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")

@dp.message(Command(commands=["id"]))
async def get_user_id(message: types.Message):
    """–ü–æ–∫–∞–∑–∞—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    user_id = message.from_user.id
    await message.answer(f"üÜî –í–∞—à ID: {user_id}\n")

@dp.message(Command(commands=["–æ–±—ä—è–≤–ª–µ–Ω–∏–µ"]))
async def create_announcement(message: types.Message):
    """–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å @everyone –≤ –∫–æ–Ω—Ü–µ"""
    if message.chat.type not in ["group", "supergroup"]:
        await message.answer("–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –≥—Ä—É–ø–ø–∞—Ö!")
        return
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ –Ω–∞—à–µ–º—É —Å–ø–∏—Å–∫—É
    user_id = message.from_user.id
    if user_id not in ADMIN_IDS:
        await message.answer(f"‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è!\n–í–∞—à ID: {user_id}")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    announcement_text = message.text.replace("/–æ–±—ä—è–≤–ª–µ–Ω–∏–µ", "").strip()
    if not announcement_text:
        await message.answer("‚ùå –£–∫–∞–∂–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã /–æ–±—ä—è–≤–ª–µ–Ω–∏–µ")
        return
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å @everyone –≤ –∫–æ–Ω—Ü–µ
    announcement_message = f"<b>üì¢ –û–ë–™–Ø–í–õ–ï–ù–ò–ï</b>\n\n{announcement_text}\n\n@everyone"
    
    try:
        await message.answer(announcement_message)
        logger.info(f"–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º {user_id}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è: {e}")
        await message.answer("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è")

@dp.message(Command(commands=["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫","–≤—Ç–æ—Ä–Ω–∏–∫","—Å—Ä–µ–¥–∞","—á–µ—Ç–≤–µ—Ä–≥","–ø—è—Ç–Ω–∏—Ü–∞","—Å—É–±–±–æ—Ç–∞","–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"]))
async def send_schedule(message: types.Message):
    """–†—É—á–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è"""
    day = message.text.replace("/", "").lower()
    week_type = get_current_week()
    
    if day in ["—Å—É–±–±–æ—Ç–∞", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"]:
        text = schedule.get(day, "‚ùå –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è")
    else:
        day_schedule = schedule.get(day)
        if day_schedule and isinstance(day_schedule, dict):
            text = day_schedule.get(week_type, "‚ùå –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è")
        else:
            text = "‚ùå –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è"
    
    message_text = f"<b>üìÖ –†–ê–°–ü–ò–°–ê–ù–ò–ï</b>\n\n{text}"
    await message.answer(message_text)

@dp.message(Command(commands=["–∞–¥–º–∏–Ω—ã"]))
async def show_admins(message: types.Message):
    """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤"""
    user_id = message.from_user.id
    if user_id in ADMIN_IDS:
        admins_list = "\n".join([str(admin_id) for admin_id in ADMIN_IDS])
        await message.answer(f"<b>üìã –¢–µ–∫—É—â–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã:</b>\n{admins_list}\n\n<b>–í–∞—à ID:</b> {user_id}")
    else:
        await message.answer(f"‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã\n–í–∞—à ID: {user_id}")

@dp.message(Command(commands=["–¥–æ–±–∞–≤–∏—Ç—å–∞–¥–º–∏–Ω"]))
async def add_admin(message: types.Message):
    """–î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–¥–º–∏–Ω–æ–≤)"""
    user_id = message.from_user.id
    if user_id not in ADMIN_IDS:
        await message.answer("‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–æ–≤!")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º ID –∏–∑ –∫–æ–º–∞–Ω–¥—ã
    try:
        new_admin_id = int(message.text.split()[1])
        ADMIN_IDS.add(new_admin_id)
        await message.answer(f"‚úÖ ID {new_admin_id} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã!\n–¢–µ–∫—É—â–∏–µ –∞–¥–º–∏–Ω—ã: {ADMIN_IDS}")
        logger.info(f"–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: {new_admin_id}")
    except (IndexError, ValueError):
        await message.answer("‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: /–¥–æ–±–∞–≤–∏—Ç—å–∞–¥–º–∏–Ω <ID_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è>")
    except Exception as e:
        await message.answer(f"‚ùå –û—à–∏–±–∫–∞: {e}")

async def on_startup():
    """–ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞"""
    scheduler.add_job(send_daily_schedule, CronTrigger(hour=4, minute=0))
    scheduler.start()
    logger.info("–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω")
    logger.info(f"–ó–∞–≥—Ä—É–∂–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã: {ADMIN_IDS}")

async def on_shutdown():
    """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –±–æ—Ç–∞"""
    scheduler.shutdown()
    logger.info("–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

async def main():
    dp.startup.register(on_startup)
    dp.shutdown.register(on_shutdown)
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
—á